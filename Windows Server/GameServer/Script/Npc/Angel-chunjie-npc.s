	//****************************************
	//
	//		Copyright:PERFECT WORLD
	//		Modified:2009/12/16
	//		Author:??
	//		TaskName:NPC-Christmas-tree.s
	//		TaskID:????
	//
	//****************************************
	
	function OnRequest(){
		

	}
//-----------------------------------????BUFF--------------------------------------
	
				function OnOption0(){
//???????
						$nullitem = GetPlayerInfo( -1, "nullitem", 0 )
						$lv = GetPlayerInfo( -1, "level")

//??????
						$give = GetPlayerVar( -1, 3930 )
						$getexp = GetPlayerVar( -1, 3931 )

//??	
						$Now_Minute =  GetSystemTime( "minute")		
						$Now_Hour =  GetSystemTime( "hour" )	
						$Now_Mday =  GetSystemTime( "mday" )	
						$Now_Month =  GetSystemTime( "month" )	
						$Now_Yday =  GetSystemTime( "yday" )	
										
										
//??????						
						if $give == $Now_Yday
								BC( "dialogbox", "player", -1, "Let's have some fun! When the Carnival ends, you can receive your reward here once a day!" )	
								return
						endif												
//??20:00-20:30?????						
						if $Now_Hour >= 0
								if $Now_Hour < 20								
										BC( "dialogbox", "player", -1, "N/A?????????20?30??22?????.???????????,??????????????." )
										return
								endif
						endif		
						if $Now_Hour >= 22
								if $Now_Hour < 24								
										BC( "dialogbox", "player", -1, "N/A?????????20?30??22?????.???????????,??????????????." )
										return
								endif
						endif				
//??????			
						if $Now_Hour == 20			
								if $Now_Minute < 30
										BC( "dialogbox", "player", -1, "N/A?????????20?30??22?????.???????????,??????????????." )
										return	
								endif
						endif


						$addbuff = AddStatus( -1, 11786 , 1 )
						BC( "dialogbox", "player", -1, "N/A????????,??????????????????????!" )						

//?????????			
						SetPlayerVar(-1,3930,$Now_Yday )			

}

//-------------------------------------------------------?????------------------------------------------------

	function OnOption1(){
		
//???????

						$nullitem = GetPlayerInfo( -1, "nullitem", 0 )
						$lv = GetPlayerInfo( -1, "level")

//??????
						$give = GetPlayerVar( -1, 3930 )
						$getexp = GetPlayerVar( -1, 3931 )
						$qd = IsExistStatus( -1 , 11786 )
//??	
						$Now_Minute =  GetSystemTime( "minute")		
						$Now_Hour =  GetSystemTime( "hour" )	
						$Now_Mday =  GetSystemTime( "mday" )	
						$Now_Month =  GetSystemTime( "month" )	
						$Now_Yday =  GetSystemTime( "yday" )	
						


										
										
//???????						
						if $give != $Now_Yday
								BC( "dialogbox", "player", -1, "N/A???????????????.?????????20?30??22?????.???????????,??????????????.")	
								return
						endif				
						
						if $qd == 0
								BC( "dialogbox", "player", -1, "N/A????????,?????!")	
								return
						endif			
						
						if $getexp == $Now_Yday
								BC( "dialogbox", "player", -1, "N/A??????????,?????!")	
								return
						endif																							
										
						if $nullitem < 1
								BC( "dialogbox", "player", -1, "N/A??????,????!")	
								return
						endif																					
						
						//?2????
						if $Now_Month == 2
							if $Now_Mday == 27
								$add = AddPlayerInfo( -1 , "item" , 63684 , 1 )
								SetPlayerVar(-1,3931,$Now_Yday )	
						
								$no = GetGlobalVar( 960 )						
								$no1 = $no + 1
								$no2 = SetGlobalVar( 960,$no1 )
								return
							endif
							
							if $Now_Mday == 28
								$add = AddPlayerInfo( -1 , "item" , 63684 , 1 )
								SetPlayerVar(-1,3931,$Now_Yday )	
						
								$no = GetGlobalVar( 960 )						
								$no1 = $no + 1
								$no2 = SetGlobalVar( 960,$no1 )
								return
							endif
						endif

						
						$add = AddPlayerInfo( -1 , "item" , 63682 , 1 )

//?????????			
						SetPlayerVar(-1,3931,$Now_Yday )	
						
						$no = GetGlobalVar( 960 )						
						$no1 = $no + 1
						$no2 = SetGlobalVar( 960,$no1 )
		
	}
	
	function OnOption2(){
		
		//????????????
		$result = IsTaskAccept( -1 , 4494 )
		if $result == 0
			BC( "dialogbox", "player", -1, "N/A??????????!" )	
			return
		endif
		
		//??????????????
		$myday = GetPlayerVar( -1, 3936 )
		$Now_Yday =  GetSystemTime( "yday" )
		if $myday == $Now_Yday
			BC( "dialogbox", "player", -1, "N/A?????????????????!" )	
			return
		endif
		
		AcceptTask( -1 , 4494 )
		SetPlayerVar( -1 , 3936 , $Now_Yday )
		
	}
	
	
	//7???????????????
	function OnOption3(){
		
		$level = GetPlayerInfo( -1 , "level" )
		if $level < 30
			BC( "dialogbox", "player", -1, "N/A??30???????Salary!" )
			return
		endif
		
		//?????????
		$myday = GetPlayerVar( -1, 3940 )
		$Now_Yday =  GetSystemTime( "yday" )
		if $myday == $Now_Yday
			BC( "dialogbox", "player", -1, "N/A??????????????,?20:00-24:00????????,?????????????????????!" )	
			return
		endif
		
		
		$Now_Mday =  GetSystemTime( "mday" )
		$Now_Month =  GetSystemTime( "month" )
		$Now_Hour =  GetSystemTime( "hour" )
		
		
		if $Now_Month != 2
			if $Now_Month != 1
				BC( "dialogbox", "player", -1, "N/A2?13,14?,15?,16?,26?,27?,28?,??8???????????????,??????????,?????????????????????!" )
				return
			endif
		endif
		
		if $Now_Hour < 20
			BC( "dialogbox", "player", -1, "N/A2?13,14?,15?,16?,26?,27?,28?,??8???????????????,??????????,?????????????????????!" )
			return
		endif
		
		
		
		if $Now_Month == 2
			if $Now_Mday == 29
				return
			endif
			
			if $Now_Mday == 30
				return
			endif
		endif
		
		if $Now_Month == 1
			if $Now_Mday == 26
				return
			endif
			
			if $Now_Mday == 27
				return
			endif
			
			if $Now_Mday == 28
				return
			endif
		endif
		
		
		
		if $Now_Mday != 13
			if $Now_Mday != 14
				if $Now_Mday != 15
					if $Now_Mday != 16
						if $Now_Mday != 26
							if $Now_Mday != 27
								if $Now_Mday != 28
									if $Now_Mday != 29
										if $Now_Mday != 30
											BC( "dialogbox", "player", -1, "N/A2?13?,14?,15?,16?,26?,27?,28?,??8???????????????,??????????,?????????????????????!" )
											return
										endif
									endif
								endif
							endif
						endif
					endif
				endif
			endif
		endif
		
		
		//????????
		$bag_count = GetPlayerInfo( -1, "nullitem", 0 )
		
		//??????????
		if $bag_count < 2
			BC( "screen", "player", -1, "You need at least 2 empty slots in your bag." )
			return
		endif
		
		//???????
		AddPlayerInfo( -1 , "item" , 59141 , 5 )
		AddPlayerInfo( -1 , "item" , 63689 , 5 )
		SetPlayerVar( -1 , 3940 , $Now_Yday )
		BC( "screen" , "player" , -1 , "N/A??????5?Salary?!???????????,?????????????????????!" )
		
	}